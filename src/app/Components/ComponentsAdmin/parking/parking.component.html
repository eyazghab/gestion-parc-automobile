<div class="container mt-5">
  <h2 class="mb-4 text-center text-primary">Liste des Parkings</h2>

  <!-- Barre de recherche -->
  <div class="mb-3">
    <input
      type="text"
      placeholder="Rechercher par nom..."
      class="form-control shadow-sm"
      [(ngModel)]="searchTerm"
    />
  </div>

  <!-- Bouton d'ajout -->
  <button class="btn btn-success mb-3" (click)="toggleForm()">
  {{ showForm ? 'Annuler' : 'Ajouter un Parking' }}
</button>

  <!-- Formulaire -->
  <div *ngIf="showForm" class="card shadow-sm mb-4 p-3 form-container">
    <h4 class="text-secondary mb-3">
      {{ parkingEnEdition ? 'Modifier le Parking' : 'Ajouter un Parking' }}
    </h4>

    <form (ngSubmit)="enregistrerParking()" #formParking="ngForm">
      <div class="mb-3">
        <label for="nomParking" class="form-label">Nom du parking</label>
        <input
          type="text"
          id="nomParking"
          [(ngModel)]="newParking.nomParking"
          name="nomParking"
          required
          class="form-control"
        />
      </div>

      <div class="mb-3">
        <label for="adresse" class="form-label">Adresse</label>
        <input
          type="text"
          id="adresse"
          [(ngModel)]="newParking.adresse"
          name="adresse"
          required
          class="form-control"
        />
      </div>

      <div class="mb-3">
        <label for="capacite" class="form-label">Capacité</label>
        <input
          type="number"
          id="capacite"
          [(ngModel)]="newParking.capacite"
          name="capacite"
          required
          min="1"
          class="form-control"
        />
      </div>

      <div class="form-check mb-3">
        <input
          type="checkbox"
          id="disponible"
          [(ngModel)]="newParking.estDisponible"
          name="estDisponible"
          class="form-check-input"
        />
        <label for="disponible" class="form-check-label">Disponible</label>
      </div>

      <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-primary me-2" [disabled]="formParking.invalid">
          {{ parkingEnEdition ? 'Mettre à jour' : 'Enregistrer' }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="annuler()">Annuler</button>
      </div>
    </form>
  </div>

  <!-- Table des parkings -->
  <div class="table-responsive shadow-sm rounded">
    <table class="table table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>Nom Parking</th>
          <th>Adresse</th>
          <th>Capacité</th>
          <th>Disponible</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let parking of filteredParkings()">
          <td>{{ parking.nomParking }}</td>
          <td>{{ parking.adresse }}</td>
          <td>{{ parking.capacite }}</td>
          <td>
            <input
              type="checkbox"
              [checked]="parking.estDisponible"
              (change)="changerDisponibilite(parking)"
            />
          </td>
          <td>
            <button class="btn btn-sm btn-primary me-1" (click)="modifier(parking)">
              <i class="bi bi-pencil-square"></i> Modifier
            </button>
            <button class="btn btn-sm btn-danger" (click)="supprimer(parking)">
              <i class="bi bi-trash"></i> Supprimer
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
